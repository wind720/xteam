<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>Homepage</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="flickity/flickity.css" media="screen">
</head>

<body>
    <div class="header">
        <div class="headertitle"><img src="images/console-controller.1024x1024.png" class="icon" alt="icon"> Xteam</div>
        <div class="oh">
            <div><a href=""><img src="images/pngegg.png" alt="shopping cart" class="cart"></a></div>
            <div>|</div>
            <div><a id="userLink" href="personalizacaoUsuario/personalizacaoUsuario.html"><img src="images/‚ÄîPngtree‚Äîuser icon_4479727.png" alt="user" class="cart"></a></div>
            <div class="us" id="loggedInUser">Sem usu√°rio</div>
        </div>
        
    </div>
    <main>
        <div class="destaque">
            <div class="pop">MAIS POPULARES
            <div class="p">CONFIRA OS JOGOS DO MOMENTO</div></div>
            <div class="gallery js-flickity" data-flickity-options='{ "freeScroll": true, "wrapAround": true }'>
                <div class="gallery-cell1"></div>
                <div class="gallery-cell2"></div>
                <div class="gallery-cell3"></div>
            </div>
        </div>
        <div class="form-container">
            <form class="search-bar">
                <label for="search-input"></label>
                <input type="text" id="search-input" placeholder="üîç Digite o nome do jogo">
            </form>
        </div>
        <div class="games">
        <section class="produto1" id="Lethal Company">
            <button>Comprar</button>
        </section>

        <section class="produto2" id="Fortnite">
            <button>Comprar</button>
        </section>

        <section class="produto3" id="Lies of P">
            <button>Comprar</button>
        </section>

        <section class="produto4" id="Celest">
            <button>Comprar</button>
        </section>

        <section class="produto5" id="Diablo IV">
            <button>Comprar</button>
        </section>

        <section class="produto6" id="Guacamelee! 2">
            <button>Comprar</button>
        </section>

        <section class="produto7" id="Five Nights At Freddy's: Security Breach">
            <button>Comprar</button>
        </section>

        <section class="produto8" id="Valorant">
            <button>Comprar</button>
        </section>

        <section class="produto9" id="Overwatch 2">
            <button>Comprar</button>
        </section>

        <section class="produto10" id="Dark Deception">
            <button>Comprar</button>
        </section>

        <section class="produto11" id="Rayman Legends">
            <button>Comprar</button>
        </section>

        <section class="produto12" id="Elden Ring">
            <button>Comprar</button>
        </section>
    </div>
    <div class="games hidden">
        <section class="produto1" id="Lethal Company">
            <button>Comprar</button>
        </section>

        <section class="produto2" id="Fortnite">
            <button>Comprar</button>
        </section>

        <section class="produto3" id="Lies of P">
            <button>Comprar</button>
        </section>

        <section class="produto4" id="Celest">
            <button>Comprar</button>
        </section>
    </div>
    </main>
    <script src="flickity/flickity.pkgd.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var searchInput = document.getElementById("search-input");
            searchInput.addEventListener("input", function () {
                var searchTerm = searchInput.value.toLowerCase();
        
                // Considera todas as se√ß√µes de jogos
                var sections = document.querySelectorAll('.games section');
        
                var visibleSections = Array.from(sections).filter(function (section) {
                    var sectionId = section.id.toLowerCase();
                    return sectionId.includes(searchTerm);
                });
        
                sections.forEach(function (section) {
                    section.style.opacity = "0";
                    section.style.transform = "translateY(-50px)";
                    section.style.position = "absolute";
                });
        
                visibleSections.forEach(function (section, index) {
                    section.style.opacity = "1";
                    section.style.transform = "translateY(0)";
                    section.style.position = "static";
                    section.style.transitionDelay = index * 0.1 + "s";
                });
            });
        
            function showLoginOrRegisterPrompt() {
                // Fazer uma requisi√ß√£o ao servidor para verificar o status de login
                fetch('/check-login')
                    .then(response => response.json())
                    .then(data => {
                        const isLoggedIn = data.isLoggedIn;
        
                        if (!isLoggedIn) {
                            const userChoice = prompt('Escolha uma op√ß√£o:\n1. Login\n2. Cadastro');
        
                            if (userChoice === '1') {
                                const username = prompt('Usu√°rio:');
                                const password = prompt('Senha:');
        
                                // Fazer uma requisi√ß√£o ao servidor para fazer login
                                fetch('/login', {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json'
                                    },
                                    body: JSON.stringify({ username, password })
                                })
                                    .then(response => {
                                        if (response.ok) {
                                            alert('Login bem-sucedido!');
                                            location.reload(); // Recarregar a p√°gina ap√≥s o login
                                        } else {
                                            alert('Credenciais inv√°lidas. Tente novamente.');
                                        }
                                    })
                                    .catch(error => {
                                        console.error('Erro ao fazer login:', error);
                                    });
                            } else if (userChoice === '2') {
                                const username = prompt('Usu√°rio:');
                                const password = prompt('Senha:');
        
                                // Fazer uma requisi√ß√£o ao servidor para fazer cadastro
                                fetch('/cadastrarUsuario', {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json'
                                    },
                                    body: JSON.stringify({ username, password })
                                })
                                    .then(response => {
                                        if (response.ok) {
                                            alert('Cadastro realizado com sucesso!');
                                        } else {
                                            alert('Erro ao cadastrar usu√°rio. Tente novamente.');
                                        }
                                    })
                                    .catch(error => {
                                        console.error('Erro ao cadastrar usu√°rio:', error);
                                    });
                            } else {
                                alert('Op√ß√£o inv√°lida ou cancelada.');
                            }
                        } else {
                            // Se o usu√°rio j√° estiver logado, redirecione para a p√°gina de personaliza√ß√£o do usu√°rio
                            alert('Voc√™ j√° est√° logado como ' + data.username);
                        }
                    })
                    .catch(error => {
                        console.error('Erro ao verificar o status de login:', error);
                    });
            }
        
            // Adicione este c√≥digo para ser executado quando o usu√°rio clicar na imagem
            document.getElementById('userLink').addEventListener('click', showLoginOrRegisterPrompt);
        });
        </script>
        
</body>

</html>